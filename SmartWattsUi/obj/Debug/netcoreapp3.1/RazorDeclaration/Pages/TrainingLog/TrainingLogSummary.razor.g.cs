#pragma checksum "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogSummary.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "57d48bfec91f148760d626b2b1dc1e5435b69ffd"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace SmartWattsUi.Pages.TrainingLog
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using SmartWattsUi;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using SmartWattsUi.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogSummary.razor"
using SmartWattsCore.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogSummary.razor"
using SmartWattsCore;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogSummary.razor"
using SmartWattsUi.Controllers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogSummary.razor"
using SmartWattsUi.Services;

#line default
#line hidden
#nullable disable
    public partial class TrainingLogSummary : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 113 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogSummary.razor"
       
	DateTime current;

	List<Ride> thisWeekRides;
	List<Ride> prevWeekRides;

	List<Ride> thisMonthRides;
	List<Ride> prevMonthToDate;
	List<Ride> prevMonthRides;

	List<Ride> thisYearRides;
	List<Ride> prevYearRides;

	List<Ride> LastWeeksRides;


	protected override void OnInitialized()
	{

		_trainingLogController.AppendHighestIntensity(_appState.LoggedInUser.Rides);

		GetInitialRideLists();
	}

	private void GetInitialRideLists()
	{
		current = DateTime.Now;
		var weekStart = Helpers.StartOfWeek(current);

		thisWeekRides = _rideServices.FilterByWeek(current).ToList();
		thisMonthRides = _rideServices.FilterByMonth(current.Month, current.Year).ToList();
		thisYearRides = _rideServices.FilterByYear(current.Year).ToList();

		prevWeekRides = _appState.LoggedInUser.Rides.Where(r => r.RideMetaData.Date > weekStart.AddDays(-7) && r.RideMetaData.Date < current.AddDays(-7)).ToList();

		prevMonthRides = _rideServices.FilterByMonth(current.AddMonths(-1).Month, current.Month != 1 ? current.Year : current.Year - 1).ToList();
		prevMonthToDate = prevMonthRides.Where(r => r.RideMetaData.Date < current.AddMonths(-1)).ToList();
		prevYearRides = _appState.LoggedInUser.Rides.Where(r => r.RideMetaData.Date.Year == current.AddYears(-1).Year && r.RideMetaData.Date < current.AddYears(-1)).ToList();

		LastWeeksRides = _appState.LoggedInUser.Rides.Where(r => r.RideMetaData.Date > weekStart.AddDays(-7) && r.RideMetaData.Date < weekStart).ToList();
	}

	private Dictionary<Intensity, int> GetIntensityOccourances(List<Ride> rides)
	{
		Dictionary<Intensity, int> intensityOccourances = new Dictionary<Intensity, int>();
		foreach (var intensity in Constants.Intensities)
		{
			intensityOccourances.Add(intensity, 0);
		}

		foreach (var ride in rides)
		{
			intensityOccourances[ride.TopIntensity] += 1;
		}

		return intensityOccourances;

	}

	private string GetTime(List<Ride> rides)
	{
		var time = rides.Sum(r => r.RideMetaData.TimeSeconds);
		return Helpers.ConvertSecToReadableLong(time);
	}

	private string GetWeeklyAvg(List<Ride> rides, int weeksIn)
	{
		var weeksIntoMonth = (float)weeksIn / 7;
		var time = rides.Sum(r => r.RideMetaData.TimeSeconds);
		return Helpers.ConvertSecToReadableLong((int)(time / weeksIntoMonth));
	}

	private string GetLastWeekTotal()
	{
		var time = LastWeeksRides.Sum(r => r.RideMetaData.TimeSeconds);
		return Helpers.ConvertSecToReadableLong(time);
	}

	private string WeekPace(List<Ride> rides)
	{
		var time = rides.Sum(r => r.RideMetaData.TimeSeconds);
		var day = (int)current.DayOfWeek == 0 ? 7 : (int)current.DayOfWeek;
		var ratio = 7 / (float)day;
		return Helpers.ConvertSecToReadableLong((int)(ratio * time));
	}


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private RideServices _rideServices { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private TrainingLogController _trainingLogController { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private RideController _rideController { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private AppState _appState { get; set; }
    }
}
#pragma warning restore 1591
