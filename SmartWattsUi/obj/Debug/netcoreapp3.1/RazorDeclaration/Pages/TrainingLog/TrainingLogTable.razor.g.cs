#pragma checksum "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogTable.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "226bd3a88a832913aa2411631d027d461a1f3f59"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace SmartWattsUi.Pages.TrainingLog
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using SmartWattsUi;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Projects\SmartWatts\SmartWattsUi\_Imports.razor"
using SmartWattsUi.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogTable.razor"
using SmartWattsUi.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogTable.razor"
using SmartWattsUi.Controllers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogTable.razor"
using SmartWattsCore.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogTable.razor"
using SmartWattsCore;

#line default
#line hidden
#nullable disable
    public partial class TrainingLogTable : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 67 "C:\Projects\SmartWatts\SmartWattsUi\Pages\TrainingLog\TrainingLogTable.razor"
           
		List<int> yearsToDisplay;
		int selectedYear = 0;
		List<int> powerPointsSelected = new List<int>() { 5, 60, 60 * 5, 60 * 20 };

		protected override void OnInitialized()
		{
			var current = DateTime.Now;
			yearsToDisplay = _rideServices.GetYearsWithRides();
		}

		private void SelectYear(int year)
		{
			selectedYear = selectedYear == year ? 0 : year;
		}

		private void PowerPointClicked(int powerPoint, EventArgs e)
		{
			if (powerPointsSelected.Contains(powerPoint))
			{
				powerPointsSelected.Remove(powerPoint);
			}
			else
			{
				powerPointsSelected.Add(powerPoint);
			}

			powerPointsSelected.Sort();
			StateHasChanged();
		}

		private int GetSinglePowerPointAvg(int pp, int year, string month = null)
		{
			var monthInt = month == null ? 0 : (int)Enum.Parse(typeof(Constants.Months), month);

			var rides = monthInt == 0 ? _rideServices.FilterByYear(year) : _rideServices.FilterByMonth(monthInt, year);
			var value = _trainingLogController.GetSinglePowerPointAvg(rides.ToList(), pp);
			return value;
		}

		private int GetYearTotalRides(int year)
		{
			var rides = _rideServices.FilterByYear(year);
			return rides.Count();
		}

		private int GetYearTotalTime(int year)
		{
			var rides = _rideServices.FilterByYear(year);
			return rides.Sum(r => r.RideMetaData.TimeSeconds);
		}

		private int GetMonthTotalRides(string month)
		{
			var monthInt = (int)Enum.Parse(typeof(Constants.Months), month);

			var rides = _rideServices.FilterByMonth(monthInt, selectedYear);
			return rides.Count();
		}

		private int GetMonthTotalTime(string month)
		{
			var monthInt = (int)Enum.Parse(typeof(Constants.Months), month);

			var rides = _rideServices.FilterByMonth(monthInt, selectedYear);
			return rides.Sum(r => r.RideMetaData.TimeSeconds);
		}

		private int GetMonthWeeklyAvg(string month)
		{
			var monthInt = (int)Enum.Parse(typeof(Constants.Months), month);
			var time = GetMonthTotalTime(month);

			var daysInMonth = DateTime.DaysInMonth(selectedYear, monthInt);

			return (int)(time / ((float)daysInMonth / 7));
		}
	

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private TrainingLogController _trainingLogController { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private RideServices _rideServices { get; set; }
    }
}
#pragma warning restore 1591
